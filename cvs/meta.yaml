{% set name = "cvs" %}
{% set version = "1.12.13" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  - url: https://ftp.gnu.org/non-gnu/cvs/source/feature/{{ version }}/cvs-{{ version }}.tar.bz2
    sha256: 78853613b9a6873a30e1cc2417f738c330e75f887afdaf7b3d0800cb19ca515e
  - url: https://opensource.apple.com/tarballs/cvs/cvs-47.tar.gz
    sha256: 643d871d6c5f3aaa1f7be626d60bd83bbdcab0f61196f51cb81e8c20e41f808a
  - url: https://raw.githubusercontent.com/Homebrew/formula-patches/24118ec737c7d008420d4683a07129ed80a759eb/cvs/vasnprintf-high-sierra-fix.diff
    sha256: affa485332f66bb182963680f90552937bf1455b855388f7c06ef6a3a25286e2
    folder: patches
  - url: https://gitweb.gentoo.org/repo/gentoo.git/plain/dev-vcs/cvs/files/cvs-1.12.13.1-fix-gnulib-SEGV-vasnprintf.patch?id=6c49fbac47ddb2c42ee285130afea56f349a2d40
    sha256: 4f4b820ca39405348895d43e0d0f75bab1def93fb7a43519f6c10229a7c64952
    folder: patches

build:
  number: 0

requirements:
  build:
    - {{ compiler('c') }}
    - autoconf
    - automake
    - gettext
    - libxcrypt
    - make
    - patch
    - vim
    - zlib
  host:
    - gettext
    - libxcrypt
    - zlib
  run:
    - gettext
    - libxcrypt
    - zlib

test:
  commands:
    - test -f $PREFIX/bin/cvs # [not win]

about:
  home: https://www.nongnu.org/cvs/
  license: GPL-2.0-or-later
  license_file: COPYING
  summary: Version control system
  dev_url: https://www.nongnu.org/cvs/

extra:
  recipe-maintainers:
    - danielnachun
